def mapear_datos_invoice(self, datos_json: dict) -> Dict[str, Any]:
    """Mapea datos de factura desde JSON a estructura BD - MAPEO COMPLETO."""
    # Buscar datos invoice en múltiples ubicaciones
    invoice_paths = ["invoice", "invoice_2x3", "factura"]
    invoice_data = {}
    for path in invoice_paths:
        if path in datos_json:
            invoice_data = datos_json[path]
            break

    return {
        'año': self.extraer_valor_seguro(invoice_data, 'año') or self.extraer_valor_seguro(invoice_data, 'ano'),
        'fecha_inicio_periodo': self.extraer_valor_seguro(invoice_data, 'fecha_inicio_periodo'),
        'fecha_fin_periodo': self.extraer_valor_seguro(invoice_data, 'fecha_fin_periodo'),
        'dias_periodo_facturado': self.extraer_valor_seguro(invoice_data, 'dias_periodo_facturado'),
        'numero_factura_rectificada': self.extraer_valor_seguro(invoice_data, 'numero_factura_rectificada'),
        'fecha_cargo': self.extraer_valor_seguro(invoice_data, 'fecha_cargo'),
        'total_a_pagar': self.extraer_valor_seguro(invoice_data, 'total_a_pagar'),
        'tipo_iva': self.extraer_valor_seguro(invoice_data, 'tipo_iva'),
        'importe_iva': self.extraer_valor_seguro(invoice_data, 'importe_iva'),
        'porcentaje_impuesto_electricidad': self.extraer_valor_seguro(invoice_data, 'porcentaje_impuesto_electricidad'),
        'importe_impuesto_electricidad': self.extraer_valor_seguro(invoice_data, 'importe_impuesto_electricidad'),
        'bono_social': self.extraer_valor_seguro(invoice_data, 'bono_social'),
        'coste_energia_total': self.extraer_valor_seguro(invoice_data, 'coste_energia_total'),
        'coste_potencia_total': self.extraer_valor_seguro(invoice_data, 'coste_potencia_total'),
        'coste_otro_concepto': self.extraer_valor_seguro(invoice_data, 'coste_otro_concepto'),
        'coste_otro_servicio': self.extraer_valor_seguro(invoice_data, 'coste_otro_servicio'),
        'coste_promedio_diario_eur': self.extraer_valor_seguro(invoice_data, 'coste_promedio_diario_eur'),
        'alquiler_contador': self.extraer_valor_seguro(invoice_data, 'alquiler_contador'),
        'ajuste_mecanismo_iberico': self.extraer_valor_seguro(invoice_data, 'ajuste_mecanismo_iberico'),
        'descuento_energia': self.extraer_valor_seguro(invoice_data, 'descuento_energia'),
        'descuento_potencia': self.extraer_valor_seguro(invoice_data, 'descuento_potencia'),
        'descuento_servicio': self.extraer_valor_seguro(invoice_data, 'descuento_servicio'),
        'descuento_otro_concepto': self.extraer_valor_seguro(invoice_data, 'descuento_otro_concepto'),
        'consumo_kwh_p1': self.extraer_valor_seguro(invoice_data, 'consumo_facturado_kwh_p1') or self.extraer_valor_seguro(invoice_data, 'consumo_medido_kwh_p1'),
        'consumo_kwh_p2': self.extraer_valor_seguro(invoice_data, 'consumo_facturado_kwh_p2') or self.extraer_valor_seguro(invoice_data, 'consumo_medido_kwh_p2'),
        'consumo_kwh_p3': self.extraer_valor_seguro(invoice_data, 'consumo_facturado_kwh_p3') or self.extraer_valor_seguro(invoice_data, 'consumo_medido_kwh_p3'),
        'consumo_kwh_p4': self.extraer_valor_seguro(invoice_data, 'consumo_facturado_kwh_p4') or self.extraer_valor_seguro(invoice_data, 'consumo_medido_kwh_p4'),
        'consumo_kwh_p5': self.extraer_valor_seguro(invoice_data, 'consumo_facturado_kwh_p5') or self.extraer_valor_seguro(invoice_data, 'consumo_medido_kwh_p5'),
        'consumo_kwh_p6': self.extraer_valor_seguro(invoice_data, 'consumo_facturado_kwh_p6') or self.extraer_valor_seguro(invoice_data, 'consumo_medido_kwh_p6'),
        'precio_peaje_p1': self.extraer_valor_seguro(invoice_data, 'precio_peaje_p1'),
        'precio_peaje_p2': self.extraer_valor_seguro(invoice_data, 'precio_peaje_p2'),
        'precio_peaje_p3': self.extraer_valor_seguro(invoice_data, 'precio_peaje_p3'),
        'precio_peaje_p4': self.extraer_valor_seguro(invoice_data, 'precio_peaje_p4'),
        'precio_peaje_p5': self.extraer_valor_seguro(invoice_data, 'precio_peaje_p5'),
        'precio_peaje_p6': self.extraer_valor_seguro(invoice_data, 'precio_peaje_p6'),
        'precio_energia_p1': self.extraer_valor_seguro(invoice_data, 'precio_energia_p1'),
        'precio_energia_p2': self.extraer_valor_seguro(invoice_data, 'precio_energia_p2'),
        'precio_energia_p3': self.extraer_valor_seguro(invoice_data, 'precio_energia_p3'),
        'precio_energia_p4': self.extraer_valor_seguro(invoice_data, 'precio_energia_p4'),
        'precio_energia_p5': self.extraer_valor_seguro(invoice_data, 'precio_energia_p5'),
        'precio_energia_p6': self.extraer_valor_seguro(invoice_data, 'precio_energia_p6'),
        'precio_cargos_energia_p1': self.extraer_valor_seguro(invoice_data, 'precio_cargos_energia_p1'),
        'precio_cargos_energia_p2': self.extraer_valor_seguro(invoice_data, 'precio_cargos_energia_p2'),
        'precio_cargos_energia_p3': self.extraer_valor_seguro(invoice_data, 'precio_cargos_energia_p3'),
        'precio_cargos_energia_p4': self.extraer_valor_seguro(invoice_data, 'precio_cargos_energia_p4'),
        'precio_cargos_energia_p5': self.extraer_valor_seguro(invoice_data, 'precio_cargos_energia_p5'),
        'precio_cargos_energia_p6': self.extraer_valor_seguro(invoice_data, 'precio_cargos_energia_p6'),
        'margen_comercializadora_p1': self.extraer_valor_seguro(invoice_data, 'margen_comercializadora_p1'),
        'margen_comercializadora_p2': self.extraer_valor_seguro(invoice_data, 'margen_comercializadora_p2'),
        'margen_comercializadora_p3': self.extraer_valor_seguro(invoice_data, 'margen_comercializadora_p3'),
        'margen_comercializadora_p4': self.extraer_valor_seguro(invoice_data, 'margen_comercializadora_p4'),
        'margen_comercializadora_p5': self.extraer_valor_seguro(invoice_data, 'margen_comercializadora_p5'),
        'margen_comercializadora_p6': self.extraer_valor_seguro(invoice_data, 'margen_comercializadora_p6'),
        'precio_total_energia_p1': self.extraer_valor_seguro(invoice_data, 'precio_total_energia_p1'),
        'precio_total_energia_p2': self.extraer_valor_seguro(invoice_data, 'precio_total_energia_p2'),
        'precio_total_energia_p3': self.extraer_valor_seguro(invoice_data, 'precio_total_energia_p3'),
        'precio_total_energia_p4': self.extraer_valor_seguro(invoice_data, 'precio_total_energia_p4'),
        'precio_total_energia_p5': self.extraer_valor_seguro(invoice_data, 'precio_total_energia_p5'),
        'precio_total_energia_p6': self.extraer_valor_seguro(invoice_data, 'precio_total_energia_p6'),
        'coste_peaje_p1': self.extraer_valor_seguro(invoice_data, 'coste_peaje_p1'),
        'coste_peaje_p2': self.extraer_valor_seguro(invoice_data, 'coste_peaje_p2'),
        'coste_peaje_p3': self.extraer_valor_seguro(invoice_data, 'coste_peaje_p3'),
        'coste_peaje_p4': self.extraer_valor_seguro(invoice_data, 'coste_peaje_p4'),
        'coste_peaje_p5': self.extraer_valor_seguro(invoice_data, 'coste_peaje_p5'),
        'coste_peaje_p6': self.extraer_valor_seguro(invoice_data, 'coste_peaje_p6'),
        'coste_energia_p1': self.extraer_valor_seguro(invoice_data, 'coste_energia_p1'),
        'coste_energia_p2': self.extraer_valor_seguro(invoice_data, 'coste_energia_p2'),
        'coste_energia_p3': self.extraer_valor_seguro(invoice_data, 'coste_energia_p3'),
        'coste_energia_p4': self.extraer_valor_seguro(invoice_data, 'coste_energia_p4'),
        'coste_energia_p5': self.extraer_valor_seguro(invoice_data, 'coste_energia_p5'),
        'coste_energia_p6': self.extraer_valor_seguro(invoice_data, 'coste_energia_p6'),
        'coste_cargos_energia_p1': self.extraer_valor_seguro(invoice_data, 'coste_cargos_energia_p1'),
        'coste_cargos_energia_p2': self.extraer_valor_seguro(invoice_data, 'coste_cargos_energia_p2'),
        'coste_cargos_energia_p3': self.extraer_valor_seguro(invoice_data, 'coste_cargos_energia_p3'),
        'coste_cargos_energia_p4': self.extraer_valor_seguro(invoice_data, 'coste_cargos_energia_p4'),
        'coste_cargos_energia_p5': self.extraer_valor_seguro(invoice_data, 'coste_cargos_energia_p5'),
        'coste_cargos_energia_p6': self.extraer_valor_seguro(invoice_data, 'coste_cargos_energia_p6'),
        'coste_margen_comercializadora_p1': self.extraer_valor_seguro(invoice_data, 'coste_margen_comercializadora_p1'),
        'coste_margen_comercializadora_p2': self.extraer_valor_seguro(invoice_data, 'coste_margen_comercializadora_p2'),
        'coste_margen_comercializadora_p3': self.extraer_valor_seguro(invoice_data, 'coste_margen_comercializadora_p3'),
        'coste_margen_comercializadora_p4': self.extraer_valor_seguro(invoice_data, 'coste_margen_comercializadora_p4'),
        'coste_margen_comercializadora_p5': self.extraer_valor_seguro(invoice_data, 'coste_margen_comercializadora_p5'),
        'coste_margen_comercializadora_p6': self.extraer_valor_seguro(invoice_data, 'coste_margen_comercializadora_p6'),
        'coste_total_energia_p1': self.extraer_valor_seguro(invoice_data, 'coste_total_energia_p1'),
        'coste_total_energia_p2': self.extraer_valor_seguro(invoice_data, 'coste_total_energia_p2'),
        'coste_total_energia_p3': self.extraer_valor_seguro(invoice_data, 'coste_total_energia_p3'),
        'coste_total_energia_p4': self.extraer_valor_seguro(invoice_data, 'coste_total_energia_p4'),
        'coste_total_energia_p5': self.extraer_valor_seguro(invoice_data, 'coste_total_energia_p5'),
        'coste_total_energia_p6': self.extraer_valor_seguro(invoice_data, 'coste_total_energia_p6'),
        'precio_peaje_potencia_p1': self.extraer_valor_seguro(invoice_data, 'precio_peaje_potencia_p1'),
        'precio_peaje_potencia_p2': self.extraer_valor_seguro(invoice_data, 'precio_peaje_potencia_p2'),
        'precio_peaje_potencia_p3': self.extraer_valor_seguro(invoice_data, 'precio_peaje_potencia_p3'),
        'precio_peaje_potencia_p4': self.extraer_valor_seguro(invoice_data, 'precio_peaje_potencia_p4'),
        'precio_peaje_potencia_p5': self.extraer_valor_seguro(invoice_data, 'precio_peaje_potencia_p5'),
        'precio_peaje_potencia_p6': self.extraer_valor_seguro(invoice_data, 'precio_peaje_potencia_p6'),
        'precio_potencia_p1': self.extraer_valor_seguro(invoice_data, 'precio_potencia_p1'),
        'precio_potencia_p2': self.extraer_valor_seguro(invoice_data, 'precio_potencia_p2'),
        'precio_potencia_p3': self.extraer_valor_seguro(invoice_data, 'precio_potencia_p3'),
        'precio_potencia_p4': self.extraer_valor_seguro(invoice_data, 'precio_potencia_p4'),
        'precio_potencia_p5': self.extraer_valor_seguro(invoice_data, 'precio_potencia_p5'),
        'precio_potencia_p6': self.extraer_valor_seguro(invoice_data, 'precio_potencia_p6'),
        'precio_cargos_potencia_p1': self.extraer_valor_seguro(invoice_data, 'precio_cargos_potencia_p1'),
        'precio_cargos_potencia_p2': self.extraer_valor_seguro(invoice_data, 'precio_cargos_potencia_p2'),
        'precio_cargos_potencia_p3': self.extraer_valor_seguro(invoice_data, 'precio_cargos_potencia_p3'),
        'precio_cargos_potencia_p4': self.extraer_valor_seguro(invoice_data, 'precio_cargos_potencia_p4'),
        'precio_cargos_potencia_p5': self.extraer_valor_seguro(invoice_data, 'precio_cargos_potencia_p5'),
        'precio_cargos_potencia_p6': self.extraer_valor_seguro(invoice_data, 'precio_cargos_potencia_p6'),
        'margen_comercializadora_potencia_p1': self.extraer_valor_seguro(invoice_data, 'margen_comercializadora_potencia_p1'),
        'margen_comercializadora_potencia_p2': self.extraer_valor_seguro(invoice_data, 'margen_comercializadora_potencia_p2'),
        'margen_comercializadora_potencia_p3': self.extraer_valor_seguro(invoice_data, 'margen_comercializadora_potencia_p3'),
        'margen_comercializadora_potencia_p4': self.extraer_valor_seguro(invoice_data, 'margen_comercializadora_potencia_p4'),
        'margen_comercializadora_potencia_p5': self.extraer_valor_seguro(invoice_data, 'margen_comercializadora_potencia_p5'),
        'margen_comercializadora_potencia_p6': self.extraer_valor_seguro(invoice_data, 'margen_comercializadora_potencia_p6'),
        'precio_total_potencia_p1': self.extraer_valor_seguro(invoice_data, 'precio_total_potencia_p1'),
        'precio_total_potencia_p2': self.extraer_valor_seguro(invoice_data, 'precio_total_potencia_p2'),
        'precio_total_potencia_p3': self.extraer_valor_seguro(invoice_data, 'precio_total_potencia_p3'),
        'precio_total_potencia_p4': self.extraer_valor_seguro(invoice_data, 'precio_total_potencia_p4'),
        'precio_total_potencia_p5': self.extraer_valor_seguro(invoice_data, 'precio_total_potencia_p5'),
        'precio_total_potencia_p6': self.extraer_valor_seguro(invoice_data, 'precio_total_potencia_p6'),
        'coste_peaje_potencia_p1': self.extraer_valor_seguro(invoice_data, 'coste_peaje_potencia_p1'),
        'coste_peaje_potencia_p2': self.extraer_valor_seguro(invoice_data, 'coste_peaje_potencia_p2'),
        'coste_peaje_potencia_p3': self.extraer_valor_seguro(invoice_data, 'coste_peaje_potencia_p3'),
        'coste_peaje_potencia_p4': self.extraer_valor_seguro(invoice_data, 'coste_peaje_potencia_p4'),
        'coste_peaje_potencia_p5': self.extraer_valor_seguro(invoice_data, 'coste_peaje_potencia_p5'),
        'coste_peaje_potencia_p6': self.extraer_valor_seguro(invoice_data, 'coste_peaje_potencia_p6'),
        'coste_potencia_p1': self.extraer_valor_seguro(invoice_data, 'coste_potencia_p1'),
        'coste_potencia_p2': self.extraer_valor_seguro(invoice_data, 'coste_potencia_p2'),
        'coste_potencia_p3': self.extraer_valor_seguro(invoice_data, 'coste_potencia_p3'),
        'coste_potencia_p4': self.extraer_valor_seguro(invoice_data, 'coste_potencia_p4'),
        'coste_potencia_p5': self.extraer_valor_seguro(invoice_data, 'coste_potencia_p5'),
        'coste_potencia_p6': self.extraer_valor_seguro(invoice_data, 'coste_potencia_p6'),
        'coste_cargos_potencia_p1': self.extraer_valor_seguro(invoice_data, 'coste_cargos_potencia_p1'),
        'coste_cargos_potencia_p2': self.extraer_valor_seguro(invoice_data, 'coste_cargos_potencia_p2'),
        'coste_cargos_potencia_p3': self.extraer_valor_seguro(invoice_data, 'coste_cargos_potencia_p3'),
        'coste_cargos_potencia_p4': self.extraer_valor_seguro(invoice_data, 'coste_cargos_potencia_p4'),
        'coste_cargos_potencia_p5': self.extraer_valor_seguro(invoice_data, 'coste_cargos_potencia_p5'),
        'coste_cargos_potencia_p6': self.extraer_valor_seguro(invoice_data, 'coste_cargos_potencia_p6'),
        'coste_margen_comercializadora_potencia_p1': self.extraer_valor_seguro(invoice_data, 'coste_margen_comercializadora_potencia_p1'),
        'coste_margen_comercializadora_potencia_p2': self.extraer_valor_seguro(invoice_data, 'coste_margen_comercializadora_potencia_p2'),
        'coste_margen_comercializadora_potencia_p3': self.extraer_valor_seguro(invoice_data, 'coste_margen_comercializadora_potencia_p3'),
        'coste_margen_comercializadora_potencia_p4': self.extraer_valor_seguro(invoice_data, 'coste_margen_comercializadora_potencia_p4'),
        'coste_margen_comercializadora_potencia_p5': self.extraer_valor_seguro(invoice_data, 'coste_margen_comercializadora_potencia_p5'),
        'coste_margen_comercializadora_potencia_p6': self.extraer_valor_seguro(invoice_data, 'coste_margen_comercializadora_potencia_p6'),
        'coste_total_potencia_p1': self.extraer_valor_seguro(invoice_data, 'coste_total_potencia_p1'),
        'coste_total_potencia_p2': self.extraer_valor_seguro(invoice_data, 'coste_total_potencia_p2'),
        'coste_total_potencia_p3': self.extraer_valor_seguro(invoice_data, 'coste_total_potencia_p3'),
        'coste_total_potencia_p4': self.extraer_valor_seguro(invoice_data, 'coste_total_potencia_p4'),
        'coste_total_potencia_p5': self.extraer_valor_seguro(invoice_data, 'coste_total_potencia_p5'),
        'coste_total_potencia_p6': self.extraer_valor_seguro(invoice_data, 'coste_total_potencia_p6'),
        'consumo_promedio_diario_kwh': self.extraer_valor_seguro(invoice_data, 'consumo_promedio_diario_kwh'),
        'potencia_facturada_p1': self.extraer_valor_seguro(invoice_data, 'potencia_facturada_p1'),
        'potencia_facturada_p2': self.extraer_valor_seguro(invoice_data, 'potencia_facturada_p2'),
        'potencia_facturada_p3': self.extraer_valor_seguro(invoice_data, 'potencia_facturada_p3'),
        'potencia_facturada_p4': self.extraer_valor_seguro(invoice_data, 'potencia_facturada_p4'),
        'potencia_facturada_p5': self.extraer_valor_seguro(invoice_data, 'potencia_facturada_p5'),
        'potencia_facturada_p6': self.extraer_valor_seguro(invoice_data, 'potencia_facturada_p6'),
        'potencia_maxima_demandada_año_kw_p1': self.extraer_valor_seguro(invoice_data, 'potencia_maxima_demandada_año_kw_p1'),
        'potencia_maxima_demandada_año_kw_p2': self.extraer_valor_seguro(invoice_data, 'potencia_maxima_demandada_año_kw_p2'),
        'potencia_maxima_demandada_año_kw_p3': self.extraer_valor_seguro(invoice_data, 'potencia_maxima_demandada_año_kw_p3'),
        'potencia_maxima_demandada_año_kw_p4': self.extraer_valor_seguro(invoice_data, 'potencia_maxima_demandada_año_kw_p4'),
        'potencia_maxima_demandada_año_kw_p5': self.extraer_valor_seguro(invoice_data, 'potencia_maxima_demandada_año_kw_p5'),
        'potencia_maxima_demandada_año_kw_p6': self.extraer_valor_seguro(invoice_data, 'potencia_maxima_demandada_año_kw_p6'),
        'coste_exceso_potencia_p1': self.extraer_valor_seguro(invoice_data, 'coste_exceso_potencia_p1'),
        'coste_exceso_potencia_p2': self.extraer_valor_seguro(invoice_data, 'coste_exceso_potencia_p2'),
        'coste_exceso_potencia_p3': self.extraer_valor_seguro(invoice_data, 'coste_exceso_potencia_p3'),
        'coste_exceso_potencia_p4': self.extraer_valor_seguro(invoice_data, 'coste_exceso_potencia_p4'),
        'coste_exceso_potencia_p5': self.extraer_valor_seguro(invoice_data, 'coste_exceso_potencia_p5'),
        'coste_exceso_potencia_p6': self.extraer_valor_seguro(invoice_data, 'coste_exceso_potencia_p6'),
        'potencia_maxima_demandada_factura_p1': self.extraer_valor_seguro(invoice_data, 'potencia_maxima_demandada_factura_p1'),
        'potencia_maxima_demandada_factura_p2': self.extraer_valor_seguro(invoice_data, 'potencia_maxima_demandada_factura_p2'),
        'potencia_maxima_demandada_factura_p3': self.extraer_valor_seguro(invoice_data, 'potencia_maxima_demandada_factura_p3'),
        'potencia_maxima_demandada_factura_p4': self.extraer_valor_seguro(invoice_data, 'potencia_maxima_demandada_factura_p4'),
        'potencia_maxima_demandada_factura_p5': self.extraer_valor_seguro(invoice_data, 'potencia_maxima_demandada_factura_p5'),
        'potencia_maxima_demandada_factura_p6': self.extraer_valor_seguro(invoice_data, 'potencia_maxima_demandada_factura_p6'),
        'autoconsumo': self.extraer_valor_seguro(invoice_data, 'autoconsumo'),
        'energia_vertida_kwh': self.extraer_valor_seguro(invoice_data, 'energia_vertida_kwh'),
        'importe_compensacion_excedentes': self.extraer_valor_seguro(invoice_data, 'importe_compensacion_excedentes'),
        'consumo_reactiva_p1': self.extraer_valor_seguro(invoice_data, 'consumo_reactiva_p1'),
        'consumo_reactiva_p2': self.extraer_valor_seguro(invoice_data, 'consumo_reactiva_p2'),
        'consumo_reactiva_p3': self.extraer_valor_seguro(invoice_data, 'consumo_reactiva_p3'),
        'consumo_reactiva_p4': self.extraer_valor_seguro(invoice_data, 'consumo_reactiva_p4'),
        'consumo_reactiva_p5': self.extraer_valor_seguro(invoice_data, 'consumo_reactiva_p5'),
        'consumo_reactiva_p6': self.extraer_valor_seguro(invoice_data, 'consumo_reactiva_p6'),
        'energia_reactiva_facturar_p1': self.extraer_valor_seguro(invoice_data, 'energia_reactiva_facturar_p1'),
        'energia_reactiva_facturar_p2': self.extraer_valor_seguro(invoice_data, 'energia_reactiva_facturar_p2'),
        'energia_reactiva_facturar_p3': self.extraer_valor_seguro(invoice_data, 'energia_reactiva_facturar_p3'),
        'energia_reactiva_facturar_p4': self.extraer_valor_seguro(invoice_data, 'energia_reactiva_facturar_p4'),
        'energia_reactiva_facturar_p5': self.extraer_valor_seguro(invoice_data, 'energia_reactiva_facturar_p5'),
        'energia_reactiva_facturar_p6': self.extraer_valor_seguro(invoice_data, 'energia_reactiva_facturar_p6'),
        'penalizacion_reactiva_p1': self.extraer_valor_seguro(invoice_data, 'penalizacion_reactiva_p1'),
        'penalizacion_reactiva_p2': self.extraer_valor_seguro(invoice_data, 'penalizacion_reactiva_p2'),
        'penalizacion_reactiva_p3': self.extraer_valor_seguro(invoice_data, 'penalizacion_reactiva_p3'),
        'penalizacion_reactiva_p4': self.extraer_valor_seguro(invoice_data, 'penalizacion_reactiva_p4'),
        'penalizacion_reactiva_p5': self.extraer_valor_seguro(invoice_data, 'penalizacion_reactiva_p5'),
        'penalizacion_reactiva_p6': self.extraer_valor_seguro(invoice_data, 'penalizacion_reactiva_p6'),
        'coste_excesos_energia_reactiva': self.extraer_valor_seguro(invoice_data, 'coste_excesos_energia_reactiva'),
        'consumo_reactiva_total': self.extraer_valor_seguro(invoice_data, 'consumo_reactiva_total'),
        'energia_reactiva_facturar_total': self.extraer_valor_seguro(invoice_data, 'energia_reactiva_facturar_total'),
        'url_qr_comparador_cnmc': self.extraer_valor_seguro(invoice_data, 'url_qr_comparador_cnmc'),
        'numero_factura': self.extraer_valor_seguro(datos_json, 'numero_factura') or self.extraer_valor_seguro(invoice_data, 'numero_factura'),
        'consumo_medido_kwh_p1': self.extraer_valor_seguro(invoice_data, 'consumo_medido_kwh_p1'),
        'consumo_medido_kwh_p2': self.extraer_valor_seguro(invoice_data, 'consumo_medido_kwh_p2'),
        'consumo_medido_kwh_p3': self.extraer_valor_seguro(invoice_data, 'consumo_medido_kwh_p3'),
        'consumo_medido_kwh_p4': self.extraer_valor_seguro(invoice_data, 'consumo_medido_kwh_p4'),
        'consumo_medido_kwh_p5': self.extraer_valor_seguro(invoice_data, 'consumo_medido_kwh_p5'),
        'consumo_medido_kwh_p6': self.extraer_valor_seguro(invoice_data, 'consumo_medido_kwh_p6'),
    }
